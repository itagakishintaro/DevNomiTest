package geb

import geb.util.*

import org.apache.poi.ss.usermodel.*
import org.jggug.kobo.gexcelapi.GExcel
import org.junit.After
import org.junit.Before
import org.junit.Test

class WebUITest {

	def file = "src/test/resources/kdt.xlsx"
	//def url = "http://54.250.224.111:8081/hotelAgile"
	def url = "http://localhost:8880/HotelAgileWebPrj/"
	Workbook book
	FormulaEvaluator evaluator

	@Before
	void setUp() {
		book = GExcel.open(file)
		evaluator = book.getCreationHelper().createFormulaEvaluator()
	}

	@After
	void tearDown() {
		book = null
		evaluator=null
	}

	@Test
	def void "空室検索（金 なし ツイン 喫煙 PC）"(){
		KDTcore.kdtByExcel(url, book[2], evaluator)
	}

	@Test
	def void "空室検索（水 連泊+早割 ツイン 禁煙 朝食）"(){
		KDTcore.kdtByExcel(url, book[3], evaluator)
	}

	@Test
	def void "空室検索（祝日 連泊+早割 シングル 喫煙 なし）"(){
		KDTcore.kdtByExcel(url, book[4], evaluator)
	}
}

